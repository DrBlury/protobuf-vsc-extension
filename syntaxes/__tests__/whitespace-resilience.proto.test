// SYNTAX TEST "source.proto" "Whitespace resilience - ensures tokenizer state is not corrupted by blank lines"

syntax = "proto3";
// <-- keyword.control.syntax.proto

package test;
// <--- keyword.control.package.proto

import "google/protobuf/timestamp.proto";
// <-- keyword.control.import.proto


// Multiple blank lines before first message should not affect highlighting


message FirstMessage {
// <--- keyword.declaration.message.proto
//      ^^^^^^^^^^^^ entity.name.type.message.proto
    int32 id = 1;
//  ^^^^^ storage.type.proto
//        ^^ variable.other.field.proto
    string name = 2;
//  ^^^^^^ storage.type.proto
//         ^^^^ variable.other.field.proto
    repeated string tags = 3;
//  ^^^^^^^^ keyword.other.modifier.proto
//           ^^^^^^ storage.type.proto
//                  ^^^^ variable.other.field.proto
}

// Comment between constructs

enum Status {
// <-keyword.declaration.enum.proto
//   ^^^^^^ entity.name.type.enum.proto
    STATUS_UNSPECIFIED = 0;
//  ^^^^^^^^^^^^^^^^^^ variable.other.enummember.proto
    STATUS_ACTIVE = 1;
//  ^^^^^^^^^^^^^ variable.other.enummember.proto
}


// Another blank line section


message SecondMessage {
// <--- keyword.declaration.message.proto
//      ^^^^^^^^^^^^^ entity.name.type.message.proto
    int32 count = 1;
//  ^^^^^ storage.type.proto
//        ^^^^^ variable.other.field.proto
    string value = 2;
//  ^^^^^^ storage.type.proto
//         ^^^^^ variable.other.field.proto
    bool enabled = 3;
//  ^^^^ storage.type.proto
//       ^^^^^^^ variable.other.field.proto
    repeated int64 numbers = 4;
//  ^^^^^^^^ keyword.other.modifier.proto
//           ^^^^^ storage.type.proto
//                 ^^^^^^^ variable.other.field.proto
}



// Three blank lines above - types must still highlight correctly



message ThirdMessage {
// <--- keyword.declaration.message.proto
    double ratio = 1;
//  ^^^^^^ storage.type.proto
    float percentage = 2;
//  ^^^^^ storage.type.proto
    uint32 unsigned_val = 3;
//  ^^^^^^ storage.type.proto
    sint64 signed_val = 4;
//  ^^^^^^ storage.type.proto
    fixed32 fixed_val = 5;
//  ^^^^^^^ storage.type.proto
    sfixed64 sfixed_val = 6;
//  ^^^^^^^^ storage.type.proto
    bytes data = 7;
//  ^^^^^ storage.type.proto
}


service TestService {
// <--- keyword.declaration.service.proto
//      ^^^^^^^^^^^ entity.name.type.service.proto
    rpc GetItem(FirstMessage) returns (SecondMessage);
//  ^^^ keyword.declaration.rpc.proto
//      ^^^^^^^ entity.name.function.rpc.proto
//              ^^^^^^^^^^^^ entity.name.type.proto
//                            ^^^^^^^ keyword.control.returns.proto
//                                     ^^^^^^^^^^^^^ entity.name.type.proto
}


// Blank lines after service


message FourthMessage {
// <--- keyword.declaration.message.proto
//      ^^^^^^^^^^^^^ entity.name.type.message.proto
    int32 final_field = 1;
//  ^^^^^ storage.type.proto
//        ^^^^^^^^^^^ variable.other.field.proto
    string last_string = 2;
//  ^^^^^^ storage.type.proto
//         ^^^^^^^^^^^ variable.other.field.proto
    optional bool opt_bool = 3;
//  ^^^^^^^^ keyword.other.modifier.proto
//           ^^^^ storage.type.proto
//                ^^^^^^^^ variable.other.field.proto
}


// Final message after many transitions between construct types


message FinalMessage {
// <--- keyword.declaration.message.proto
    int32 a = 1;
//  ^^^^^ storage.type.proto
    string b = 2;
//  ^^^^^^ storage.type.proto
    repeated int32 c = 3;
//  ^^^^^^^^ keyword.other.modifier.proto
//           ^^^^^ storage.type.proto
}
